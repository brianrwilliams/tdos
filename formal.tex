\section{(Twisted) Differential operators via formal geometry}

The purpose of this section is to describe twisted differential operators using the language of Gelfand-Kazhdan formal geometry. 

\subsection{A quick review of descent}

Our approach to studying topological mechanics relies on a description of the target smooth manifold in the style of formal geometry. 
As we have discussed, our method is to consider topological mechanics on the {\em formal disk} that is equivariant for the action of all formal automorphisms. 
To obtain topological mechanics on a smooth manifold $X$ we apply {\em Gefland-Kazhdan descent} to this theory on the formal disk.

We will thus rely on a description of twisted differential operators on $X$ in the style of formal geometry. 
Our formulation is largely motivated by the works of Kontsevich \cite{KontsevichDQ1}, Fedosov \cite{Fedosov}, and Nest-Tsygan \cite{NT1} n their approaches to deformation quantization and the algebraic index theorem.
It also bears a close relationship to approaches made later on by Cattaneo-Felder-Tomassini \cite{CFGlobalization, CFTomassini}.
Because of the multitude of references already out there, we make our discussion brief and to the point. 

The setting of formal geometry that we consider has its foundations in the work of Gelfand and Kazhdan \cite{GK}.
Categorically, the outcome is a construction of ``natural" objects in differential geometry in a functorial way from objects on the formal disk.  
By natural, we mean that these construction apply uniformly over the category of smooth manifolds (of a fixed dimension) possibly equipped with a local geometry (such as a symplectic or complex structure). 
Our construction of the one-dimensional theory via Gelfand-Kazhdan descent is very close to the last two author's construction of {\em chiral differential operators} from BV quantization in \cite{GGW}. 

The central object, associated to each smooth $n$-manifold $X$, is the bundle of coordinates $X^{coor}$. 
The fiber over a point $x \in X$ consists of the space of formal coordinates centered at $x$. 
This is the space of $\infty$-jets of local diffeomorphisms of the $n$-disk $D^n$ to an open neighborhood of $x$ sending $0 \in D^n$ to $x$. 
In other words, this is the space of maps from the {\em formal disk} $\hD^n$ to the formal completion of $X$ near the point $x$. 
The formal disk $\hD^n$ is defined as the affine formal scheme with ring of functions given by formal power series $\RR[[t_1,\ldots,t_n]]$.
The bundle $X^{coor} \to X$ is a principal bundle for the group of automorphisms of this formal scheme that fix the maximal ideal, which we denote $\Aut_n$. 
This principal $\Aut_n$-bundle factors through the ordinary $\GL_n$ frame bundle $\Fr_X \to X$, in since there is a natural map of bundles $X^{coor} \to {\rm Fr}_X$ that truncates the full $\infty$-jet to remember only the linear jet. 

The crucial point is that this principal $\Aut_n$-bundle carries a {\em flat connection}. 
The flat connection is valued in the Lie algebra of {\em all} formal vector fields $\Vect$.	
The Lie algebra of $\Aut_n$ consists of formal vector fields that vanish at the origin, which is a strict sub Lie algebra of all formal vector fields, so we are leaving the ordinary category of principal bundles with connection. 

\subsubsection{Formal to global}

What we call Gelfand-Kazhdan descent is the functorial prescription of taking objects on the formal disk and gluing them over an arbitrary smooth manifold.
The descent functor takes as input a geometric object (like a vector bundle) on the formal disk and outputs a universal object on the category of smooth manifolds. 

Consider the map that projects onto the linear jet of the formal coordinate
\ben
\pi_1 : X^{coor} \to \Fr_X .
\een
Splittings of this map that are equivariant for the group $\GL_n$ of this map always exist. 
Locally, such a splitting amounts to exponentiating a linear frame to a full formal coordinate.

\begin{rmk}
Every \brian{torsion free} connection $\nabla$ on $X$ defines a global exponentiation and hence a splitting $\sigma_\nabla : \Fr_X \to X^{coor}$ of $\pi_1$. 
\brian{reference?}
\end{rmk}

The flat connection on $X^{coor}$ determines an element $\omega \in \Omega^1(X^{coor} ; \Vect)$. 
Using the splitting, we can pull-back this flat connection to obtain a $\GL_n$-invariant element $\omega_\nabla := \sigma_\nabla^* \omega^{coor} \in \Omega^1(\Fr_X ; \Vect)$ satisfying 
\ben
\d \omega_\nabla + \frac{1}{2}[\omega_\nabla,\omega_\nabla] = 0
\een
where $\d$ is the de Rham differential on $\Fr_X$ and $[-,-]$ is the Lie bracket of formal vector fields extended to the de Rham complex.

To define descent, we need to fix a category of modules for formal vector fields and $\GL_n$.
The class of objects we consider are $\GL_n$-representations $\sV$ (possibly infinite dimensional) that have a compatible structure of a topological $\Vect$-module. 
We denote this category of modules by $\Mod_{(\Vect, \GL_n)}$. 
Precisely, these are modules for the Harish--Chandra pair $(\Vect, \GL_n)$, whose underlying $\Vect$-module structure is continuous. 

We want to consider modules that behave like vector bundles on the formal disk. 
Let $\hO_n = \CC[[t_1,\ldots,t_n]]$ denote the ring of formal power series.
If $\sV$ is a $(\Vect, \GL_n)$-module we require that it admits a $\GL_n$-equivariant splitting
\ben
\sV = \hO_n \tensor_\CC V
\een
where $\GL_n$ acts on $\hO_n$ in the natural way, and $V$ is some finite dimensional $\GL_n$-representation. 
We refer to such objects as {\em formal vector bundles}. 
They form a category that we denote $\VB_n$. 

We denote the category of smooth finite dimensional vector bundles on $X$ by $\VB_X$. 
Let ${\rm Pro}(\VB_X)$ denote the category of pro-vector bundles. 
An object in ${\rm Pro}(\VB_X)$ consists of a sequence of vector bundles 
\brian{Did we flip pro and ind objects in the CDO paper?}

We are now ready to define the descent functor.

\begin{dfn} Let $X$ be a smooth manifold equipped with a connection. 
Define the functor
\ben
\desc_X : \VB_n \to \Pro(\VB_X))_{flat}
\een
that sends a formal vector bundle $\sV = \hO_n \tensor V$ to the pro vector bundle...\brian{I'm worried I'm mixing up pro and ind}
\end{dfn}

Given a flat vector bundle we can take its flat sections to obtain a sheaf on $X$. 
For the flat bundle $\desc_X(\cV)$ we denote this sheaf by $\sdesc_X(\sV)$.
This sheaf is automatically locally free and hence corresponds to the sheaf of sections of a finite dimensional vector bundle. 

\subsubsection{Characteristic classes}

An exact sequence of formal vector bundles 
\ben
\sA \to \sB \to \sC
\een
is classified by an element in the ext-group $\Ext_{\VB_n}^1(\sC, \sA)$. 
In \cite{GGW} we show that for each $k$ the ext-group $\Ext^k_{\VB_n}(\sC, \sA)$ is canonically identified with the {\em relative Chevalley--Eilenberg cochains} $\clie^k(W_n , \GL_n ; \sC^\vee \tensor_{\hO_n} \sA)$, where the $(-)^\vee$ denotes the $\hO_n$-linear dual. 


In Lemma 2.28 of \cite{GGW} we prove that the functor $\sdesc_X(-)$ is exact. 
In particular, applied to the exact sequence \ref{exact seq} is an exact sequence of formal vector bundles we obtain a map 
\ben
{\rm char}_X : \clie^k(W_n , \GL_n ; \sC^\vee \tensor_{\hO_n} \sA) \to H^k(X ; \sdesc_X(\sC)^\vee \tensor_{\sO_X} \sdesc_X(\sA)) .
\een
that we call the {\em characteristic map}.

\subsection{Formal Lie algebroids}

In this section we define formal Lie algebroids.
These are Lie algebroids on the formal disk, in the same way that the category $\VB_n$ provides a model for vector bundles on the formal $n$-disk. 

\begin{dfn} A {\em formal Lie algebroid} is an object $\sL \in \VB_n$ together with
\begin{itemize}
\item[(i)] A $\CC$-linear bracket $[-,-] : \sL \times \sL \to \sL$ and
\item[(ii)] an ``anchor" map $a : \sL \to \hT_n$
\end{itemize}
such that 
\begin{itemize}
\item[(1)] $[-,-]$ and $a$ are equivariant for the action of $(\Vect, \GL_n)$,
\item[(2)] $a$ is $\hO$-linear, and
\item[(3)] for any $x,y\in \sL$ and $f \in \hO_n$ one has
\ben
[x, f \cdot y] -  f \cdot [x,y]  = a(x)\cdot f .
\een
\end{itemize}
\end{dfn}

\begin{rmk} Formal Lie algebroids are precisely Lie--Rinehart algebras over the ring $\hO_n$ that are equivariant for the pair $(\Vect, \GL_n)$. 
\end{rmk}

We define the category $\Algd_n$ to be the full subcategory of $\VB_n$ consisting of formal Lie algebroids.
The following is an immediate consequence of the functoriality of descent.

\begin{lem}
Suppose $\sL$ is a formal Lie algebroid. 
Then, $\sdesc_X(\sL)$ has the structure of a Lie algebroid on $X$.
\end{lem}

It is immediate to see that the descent of the formal Lie algebroid $\hT_n$ is the standard Lie algebroid. 

\subsubsection{Enveloping algebroid}

To any Lie algebra we can assign an associative algebra through its universal enveloping algebra. \brian{blah blah}

Let $\sL$ be a formal Lie algebroid. Consider the left $\hO_n$-module
$\hO_n \oplus \sL$. This direct sum has a natural Lie algebra
structure given by
\ben
[(f, x), (g,y)] := (a(x) \cdot f - a(y) \cdot g, [x,y]) .
\een 
Let $U_{\rm Lie}(\hO_n \oplus \sL)$ be the universal envelope of this
Lie algebra. 
Note that there is a natural augmentation map $\epsilon : U_{\rm Lie}(\hO_n \oplus \sL) \to \RR$.

\begin{dfn}
Let $\sL$ be a formal Lie algebroid. 
Denote by $\Bar{U}$ the augmentation ideal with respect to $\epsilon$, and let $I\subset \Bar{U}$ be the ideal generated by
\ben
i(f,0) \tensor i(g,x) - i(fg, f x) 
\een 
for $x \in \sL$ and $f,g\in \hO_n$.
The {\em enveloping algebra} of the formal Lie algebroid $\cL$ is the quotient
\ben
\sU_{\hO_n} (\sL) := \Bar{U} / I .
\een 
\end{dfn}

It is immediate to see that $\sU_{\hO_n}(\sL)$ is an associative algebra object in the category of formal vector bundles. 
By monoidality of the descent functor, we $\sdesc_{\GK}(\sL)$ is a sheaf of associative algebras on the category of $n$-manifolds. 

\begin{eg} 
Consider the $\hO_n$-module  $\hT_n$, which has a natural formal Lie
  algebroid structure via the Lie bracket of vector
  fields. The anchor map is the identity map. It is straightforward to exhibit
  an isomorphism $\sU_{\hO_n} (\hT_n) \cong \hA_n$ of algebras in the category $\VB_n$.
\end{eg}

We have already mentioned that $\sdesc$ is exact, it in particular preserves finite colimits.  
An immediate corrollary of this is the following.

\begin{cor}\label{prop:enveloping}
Let $\sL$ be a formal Lie algebroid and $X$ a smooth manifold. 
Then, there is an isomorphism of sheaves of associative algebras on~$X$:
\ben
\sdesc_X(\sU_{\hO_n}\sL) \cong \sU_{\sO_X} (\sdesc(\sL)) .
\een
\end{cor}

\begin{eg} 
Let $\hA_n$ denote the associative Weyl algebra on generators $t_1,\ldots, t_n$ and $\frac{\partial}{\partial t_1},\ldots, \frac{\partial}{\partial t_n}$. 
The relation is $[\frac{\partial}{\partial t_i}, t_j] = \delta_{ij}$. 
Consider the formal vector bundle $\hT_n$, which has a natural formal Lie
  algebroid structure via the Lie bracket of vector
  fields. The anchor map is the identity map. It is straightforward to exhibit
  an isomorphism $\sU_{\hO_n} (\hT_n) \cong \hA_n$ of algebras in $(\Vect, \GL_n)$-modules.
\end{eg}


